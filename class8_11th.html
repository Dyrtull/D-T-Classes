<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Production Mastery: IGCSE ICT 0417</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

        :root {
            --bg-color-light: #f3f4f6;
            --text-color-light: #1f2937;
            --card-bg-light: #ffffff;
            --primary-color-light: #4c4c4c;
            --secondary-color-light: #e5e7eb;
            --accent-color-light: #3b82f6;
        }

        [data-theme='dark'] {
            --bg-color-light: #111827;
            --text-color-light: #f3f4f6;
            --card-bg-light: #1f2937;
            --primary-color-light: #a0aec0;
            --secondary-color-light: #2d3748;
            --accent-color-light: #93c5fd;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color-light);
            color: var(--text-color-light);
            line-height: 1.6;
            transition: background-color 0.3s, color 0.3s;
            margin: 0;
            padding: 0;
            scroll-behavior: smooth;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        header {
            background-color: var(--card-bg-light);
            border-bottom: 2px solid var(--secondary-color-light);
            /* --- MODIFICATION: Reduced vertical padding from 1rem to 0.5rem --- */
            padding: 0.5rem 1.5rem; 
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color-light);
        }

        nav a {
            color: var(--primary-color-light);
            text-decoration: none;
            margin-left: 1rem;
            font-weight: 600;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
        }
        
        nav a:hover {
            background-color: var(--secondary-color-light);
        }
        
        .progress-bar-container {
            width: 100%;
            height: 8px;
            background-color: var(--secondary-color-light);
            border-radius: 4px;
            /* --- MODIFICATION: Reduced margin-top from 1rem to 0.25rem for a tighter fit --- */
            margin-top: 0.25rem; 
        }
        
        .progress-bar {
            height: 100%;
            background-color: var(--accent-color-light);
            border-radius: 4px;
            transition: width 0.5s ease-in-out;
        }
        
        main {
            padding-top: 2rem;
        }
        
        .section {
            background-color: var(--card-bg-light);
            border-radius: 1rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h2 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color-light);
            border-bottom: 2px solid var(--accent-color-light);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary-color-light);
            margin-top: 1.5rem;
        }
        
        p {
            margin-bottom: 1rem;
        }
        
        .toggle-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-color-light);
        }
        
        .card {
            background-color: var(--secondary-color-light);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .card-content {
            display: none;
            padding-top: 1rem;
        }
        
        .card-content.active {
            display: block;
        }
        
        .card-title {
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .accordion-icon {
            transform: rotate(0deg);
            transition: transform 0.3s;
        }
        
        .card-content.active + .card-title .accordion-icon {
            transform: rotate(180deg);
        }
        
        .btn {
            background-color: var(--accent-color-light);
            color: #fff;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s;
            margin-top: 1rem;
        }
        
        .btn:hover {
            background-color: #2563eb;
        }
        
        .interactive-section {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        
        .drag-container, .drop-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            padding: 1rem;
            border: 2px dashed var(--secondary-color-light);
            border-radius: 0.75rem;
        }
        
        .drag-item {
            background-color: var(--card-bg-light);
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            cursor: grab;
            border: 1px solid var(--secondary-color-light);
        }
        
        .drop-target {
            background-color: var(--secondary-color-light);
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            min-width: 100px;
            text-align: center;
        }
        
        .correct {
            background-color: #bbf7d0 !important;
        }
        
        .incorrect {
            background-color: #fecaca !important;
        }
        
        .fill-in-the-blank {
            display: inline-block;
            border-bottom: 2px solid var(--accent-color-light);
            padding: 0.25rem 0.5rem;
            min-width: 100px;
            text-align: center;
        }
        
        .fill-in-the-blank input {
            background: none;
            border: none;
            border-bottom: 2px solid var(--accent-color-light);
            text-align: center;
            color: inherit;
        }

        .fill-in-the-blank input:focus {
            outline: none;
        }
        
        .multiple-choice-option {
            background-color: var(--secondary-color-light);
            padding: 1rem;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .multiple-choice-option:hover {
            background-color: #d1d5db;
        }
        
        .feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 0.75rem;
        }
        
        .feedback.correct {
            background-color: #bbf7d0;
        }
        
        .feedback.incorrect {
            background-color: #fecaca;
        }
        
        .vocabulary-list {
            list-style: none;
            padding: 0;
        }
        
        .vocabulary-list li {
            background-color: var(--secondary-color-light);
            padding: 1rem;
            border-radius: 0.75rem;
            margin-bottom: 1rem;
        }

        .speak-btn {
            background: none;
            border: none;
            font-size: 1rem;
            cursor: pointer;
            margin-left: 0.5rem;
        }

        .icon {
            display: inline-block;
            width: 1.2em;
            height: 1.2em;
            vertical-align: middle;
            fill: currentColor;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }
            .title {
                margin-bottom: 0.5rem;
            }
            nav {
                display: none;
            }
        }
    </style>
</head>
<body data-theme="light">
    <header>
        <!-- The 'container' class limits the width of the content, which is correct here -->
        <div class="container header-content">
            <h1 class="title">Document Production Mastery</h1>
            <button class="toggle-btn" id="theme-toggle">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </button>
        </div>
        <!-- The progress bar is designed to be full-width, which is correct -->
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar" style="width: 0%;"></div>
        </div>
    </header>

    <main class="container">
        <section id="objectives" class="section">
            <h2>1. Objectives & Introduction (5-10 min)</h2>
            <div class="card">
                <div class="card-title">
                    Cognitive Goals
                    <svg class="icon accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>
                <div class="card-content">
                    <p>By the end of this class, you will be able to:</p>
                    <ul>
                        <li>Understand the purpose of page layout settings.</li>
                        <li>Apply various page layout options (page size, orientation, margins, columns, breaks).</li>
                        <li>Format text using line spacing, paragraph spacing, tabulation, indentation, and text enhancements.</li>
                        <li>Create and edit bulleted and numbered lists.</li>
                        <li>Utilize the Find and Replace feature effectively.</li>
                        <li>Add and delete bookmarks and hyperlinks for navigation.</li>
                    </ul>
                </div>
            </div>
            <div class="card">
                <div class="card-title">
                    SEL Goals
                    <svg class="icon accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>
                <div class="card-content">
                    <p>This class will help you to:</p>
                    <ul>
                        <li>Develop attention to detail and precision.</li>
                        <li>Promote efficiency and accuracy.</li>
                        <li>Encourage logical organization and user-friendly design.</li>
                        <li>Foster a sense of accomplishment through creating visually appealing documents.</li>
                    </ul>
                </div>
            </div>
            <p><strong>Initial Motivation:</strong> Think about the last time you read a poorly formatted document or a confusing website. How did it make you feel? How can mastering these skills help you avoid those mistakes and present information clearly and professionally?</p>
        </section>

        <section id="concepts" class="section">
            <h2>2. Concept Exploration (20-25 min)</h2>
            <div class="card">
                <div class="card-title">
                    Page Layout: The Blueprint of Your Document
                    <svg class="icon accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>
                <div class="card-content">
                    <p><strong>Page Layout</strong> defines how your document is structured visually. This includes margins, orientation, and breaks.</p>
                    <h3>Key Concepts:</h3>
                    <ul>
                        <li><strong>Page Size:</strong> The physical dimensions of the paper (e.g., A4, Letter).</li>
                        <li><strong>Page Orientation:</strong> The direction of the paper (Portrait or Landscape).</li>
                        <li><strong>Page Margins:</strong> The blank space between the text and the edge of the page.
                            <div class="card-content-advanced">
                                <p><strong>Deeper Dive: Gutter Margin</strong>
                                    A <strong>gutter margin</strong> is an extra margin added to the side of a document that will be bound, such as a book or report. Its purpose is to ensure that the text is not obscured when the pages are punched or stapled together.
                                    <br>
                                </p>
                            </div>
                        </li>
                        <li><strong>Columns:</strong> Dividing the text into vertical sections, common in newsletters and newspapers.</li>
                        <li><strong>Breaks:</strong> Special markers that control the flow of text and formatting.
                            <div class="card-content-advanced">
                                <p><strong>Advanced: Section Breaks</strong>
                                    Unlike simple page breaks, a **section break** allows you to change the page formatting for only the subsequent text. This is how you can have a landscape page in the middle of a portrait document. There are two main types of section breaks: Next Page and Continuous.
                                </p>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="card">
                <div class="card-title">
                    Text Formatting: Making Text Work for You
                    <svg class="icon accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>
                <div class="card-content">
                    <p>Text formatting is about making your content readable and consistent.</p>
                    <h3>Key Concepts:</h3>
                    <ul>
                        <li><strong>Line Spacing:</strong> The vertical distance between lines of text. Can be single, double, or set to an exact value (e.g., 14pt).</li>
                        <li><strong>Paragraph Spacing:</strong> The space before and after each paragraph.</li>
                        <li><strong>Tabulation:</strong> Using tabs to align text. A common challenge is using **decimal tabs** to perfectly align numbers with their decimal points.</li>
                        <li><strong>Indentation:</strong> The space at the start of a line, or a **hanging paragraph** where the first line is not indented, but subsequent lines are.</li>
                        <li><strong>Text Enhancement:</strong> Applying effects like <strong>bold</strong>, <em>italic</em>, <u>underline</u>, or using <sup>superscript</sup> and <sub>subscript</sub>.</li>
                        <li><strong>Lists:</strong> Organizing items using either <strong>numbered lists</strong> for sequential steps or <strong>bulleted lists</strong> for non-sequential items. A **multi-level list** is a list with sub-lists (e.g., 1.1, 1.1.1).</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="applied" class="section">
            <h2>3. Applied Examples (15-20 min)</h2>
            <p>Let's see how these concepts are used in practice. Follow the steps for each case. You can click 'Show Solution' to check your work.</p>
            <h3>Case 1: "Poem Formatting"</h3>
            <p>A poem needs special formatting to be readable. Follow these steps for the text below:</p>
            <p>"The wind whispers soft,<br>Through the trees so tall,<br>A gentle, calming breeze,<br>Answering nature's call."</p>
            <ol>
                <li>Set the line spacing to 'Exactly 18pt' to give the lines more room.</li>
                <li>Make the words "wind" and "breeze" **bold**.</li>
                <li>Make the last line "Answering nature's call" <em>italic</em>.</li>
            </ol>
            <button class="btn" onclick="document.getElementById('solution1').style.display='block'">Show Solution</button>
            <div id="solution1" style="display:none; margin-top:1rem;">
                <p>To set the line spacing, you need to use the advanced paragraph settings. The bold and italic enhancements are found on the Home ribbon.</p>
            </div>
        </section>

        <section id="activities" class="section">
            <h2>4. Interactive Activities (25-35 min)</h2>
            <p>Test your understanding with these interactive challenges. You will get points for each correct answer!</p>
            <div id="score-display" style="text-align: right; font-weight: bold; margin-bottom: 1rem;">Score: 0</div>
            
            <!-- Drag and Drop Activity -->
            <h3>Activity 1: Drag & Drop</h3>
            <p>Drag the concepts from the box below to their correct definitions. When you're done, click the 'Check' button.</p>
            <div class="drop-container" id="drop-container-dd">
                <div class="drop-target" data-answer="Section Break">Allows different page layouts in one document</div>
                <div class="drop-target" data-answer="Gutter Margin">Extra space for binding</div>
                <div class="drop-target" data-answer="Decimal Tab">Aligns numbers by their decimal point</div>
            </div>
            <div class="drag-container" id="drag-container-dd">
                <div class="drag-item" draggable="true" data-name="Section Break">Section Break</div>
                <div class="drag-item" draggable="true" data-name="Gutter Margin">Gutter Margin</div>
                <div class="drag-item" draggable="true" data-name="Decimal Tab">Decimal Tab</div>
            </div>
            <button class="btn" onclick="checkDragAndDrop()">Check Answers</button>
            <div id="dd-feedback" class="feedback"></div>

            <!-- Fill-in-the-Blank Activity -->
            <h3>Activity 2: Fill-in-the-Blank</h3>
            <p>Complete the sentence using the correct words.</p>
            <p>To change the page orientation from Portrait to Landscape for only one page in a document, you must insert a 
                <span class="fill-in-the-blank"><input type="text" id="blank1" placeholder="..."></span>
                break, which allows you to apply different formatting to a new section.
            </p>
            <button class="btn" onclick="checkFillInTheBlank()">Check Answer</button>
            <div id="fitb-feedback" class="feedback"></div>

            <!-- Multiple Choice Activity -->
            <h3>Activity 3: Find & Replace</h3>
            <p>When using Find and Replace to change the word "computer" to "ICT device," but *only* if "computer" is not capitalized, which option should you enable?</p>
            <div class="multiple-choice-container">
                <div class="multiple-choice-option" onclick="checkMultipleChoice(this, 'correct')">Match case</div>
                <div class="multiple-choice-option" onclick="checkMultipleChoice(this, 'incorrect')">Find whole words only</div>
                <div class="multiple-choice-option" onclick="checkMultipleChoice(this, 'incorrect')">Ignore punctuation</div>
            </div>
            <div id="mc-feedback" class="feedback"></div>
        </section>

        <section id="practice" class="section">
            <h2>5. Practice Exercises (15-20 min)</h2>
            <p>Apply your skills to these hands-on exercises based on the IGCSE syllabus. These are designed to be challenging. Ask for a hint if you need it!</p>
            <div class="card">
                <div class="card-title">
                    Exercise Bank
                    <svg class="icon accordion-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </div>
                <div class="card-content">
                    <p><strong>Practice 1: Project Outline</strong></p>
                    <p>Create a multi-level numbered list for a project outline. Use the following structure:
                    <br>1. Project Name
                    <br>&nbsp;&nbsp;&nbsp;&nbsp;1.1 Phase 1
                    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.1.1 Task A
                    <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.1.2 Task B</p>
                    <p><strong>Practice 2: Tabulated List</strong></p>
                    <p>Using decimal tabs, create a list of items and prices that aligns perfectly on the decimal point, like this:
                    <br>Item A . . . . . . . . . . 12.50
                    <br>Item B . . . . . . . . . . 1.25</p>
                </div>
            </div>
        </section>

        <section id="synthesis" class="section">
            <h2>6. Synthesis & Assessment (10-15 min)</h2>
            <p>Time to review and reflect on what you've learned. </p>
            <h3>Self-Assessment Checklist</h3>
            <p>Check off the skills you feel confident in. Be honest with yourself!</p>
            <form>
                <input type="checkbox"> I can apply page size, orientation, and margins.<br>
                <input type="checkbox"> I understand the purpose of section breaks.<br>
                <input type="checkbox"> I can format text with line and paragraph spacing.<br>
                <input type="checkbox"> I can create multi-level lists.<br>
                <input type="checkbox"> I can use Find and Replace with advanced options.<br>
                <input type="checkbox"> I can create and use bookmarks and hyperlinks.<br>
            </form>
            <p><strong>Reflect & Differentiate:</strong> How would you explain the difference between a page break and a section break to someone who has never used a word processor? What was the most challenging concept for you today?</p>
        </section>
        
        <section id="vocabulary" class="section">
            <h2>Vocabulary (Optional)</h2>
            <p>Review the key terms from this lesson. Click the speaker icon to hear the pronunciation.</p>
            <ul class="vocabulary-list">
                <li>
                    <strong>Page Layout</strong>
                    <button class="speak-btn" onclick="speakText('Page Layout')">
                        <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 5L6 9H2v6h4l5 4V5z"></path>
                            <path d="M19.07 4.93a10 10 0 0 1 0 14.14M21.94 2.06a15 15 0 0 1 0 20.88"></path>
                        </svg>
                    </button>
                    <p>The overall visual arrangement of a document, including margins, columns, and orientation.</p>
                </li>
                <li>
                    <strong>Gutter Margin</strong>
                    <button class="speak-btn" onclick="speakText('Gutter Margin')">
                        <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 5L6 9H2v6h4l5 4V5z"></path>
                            <path d="M19.07 4.93a10 10 0 0 1 0 14.14M21.94 2.06a15 15 0 0 1 0 20.88"></path>
                        </svg>
                    </button>
                    <p>Extra space added to the side margin for a document that will be bound.</p>
                </li>
                <li>
                    <strong>Section Break</strong>
                    <button class="speak-btn" onclick="speakText('Section Break')">
                        <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 5L6 9H2v6h4l5 4V5z"></path>
                            <path d="M19.07 4.93a10 10 0 0 1 0 14.14M21.94 2.06a15 15 0 0 1 0 20.88"></path>
                        </svg>
                    </button>
                    <p>A type of break that allows you to change the formatting of a new part of the document.</p>
                </li>
                 <li>
                    <strong>Superscript</strong>
                    <button class="speak-btn" onclick="speakText('Superscript')">
                        <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 5L6 9H2v6h4l5 4V5z"></path>
                            <path d="M19.07 4.93a10 10 0 0 1 0 14.14M21.94 2.06a15 15 0 0 1 0 20.88"></path>
                        </svg>
                    </button>
                    <p>A character positioned slightly above the normal line of text (e.g., in a footnote or mathematical equation like x²).</p>
                </li>
                 <li>
                    <strong>Subscript</strong>
                    <button class="speak-btn" onclick="speakText('Subscript')">
                        <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 5L6 9H2v6h4l5 4V5z"></path>
                            <path d="M19.07 4.93a10 10 0 0 1 0 14.14M21.94 2.06a15 15 0 0 1 0 20.88"></path>
                        </svg>
                    </button>
                    <p>A character positioned slightly below the normal line of text (e.g., in a chemical formula like H₂O).</p>
                </li>
            </ul>
        </section>

    </main>

    <script>
        const themeToggle = document.getElementById('theme-toggle');
        const progressBar = document.getElementById('progressBar');
        // Fallback for localStorage just in case, though standard practice is to use it.
        let score = parseInt(localStorage.getItem('classScore')) || 0;
        let progress = parseFloat(localStorage.getItem('classProgress')) || 0;

        document.addEventListener('DOMContentLoaded', () => {
            document.body.setAttribute('data-theme', localStorage.getItem('theme') || 'light');
            updateProgressBar();
            document.getElementById('score-display').textContent = `Score: ${score}`;

            document.querySelectorAll('.card').forEach(card => {
                const title = card.querySelector('.card-title');
                const content = card.querySelector('.card-content');
                title.addEventListener('click', () => {
                    content.classList.toggle('active');
                    // Optional: Toggle the icon's rotation
                    title.querySelector('.accordion-icon').style.transform = content.classList.contains('active') ? 'rotate(180deg)' : 'rotate(0deg)';
                });
            });

            // Drag and Drop
            const dragContainer = document.getElementById('drag-container-dd');
            const dropContainer = document.getElementById('drop-container-dd');
            let draggedItem = null;

            dragContainer.addEventListener('dragstart', (e) => {
                draggedItem = e.target;
                e.dataTransfer.setData('text/plain', draggedItem.dataset.name);
            });

            dropContainer.addEventListener('dragover', (e) => {
                e.preventDefault();
            });

            dropContainer.addEventListener('drop', (e) => {
                e.preventDefault();
                const dropTarget = e.target.closest('.drop-target');
                // Ensure drop target exists and it doesn't already contain a drag item
                if (dropTarget && !dropTarget.querySelector('.drag-item')) {
                    dropTarget.appendChild(draggedItem);
                }
            });
        });

        themeToggle.addEventListener('click', () => {
            const currentTheme = document.body.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });

        // Simple scroll observer to update progress bar based on section visibility
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    updateProgressBar(entry.target.id);
                }
            });
        }, {
            root: null, // viewport
            rootMargin: '0px 0px -50% 0px', // When section is halfway visible
            threshold: 0.1
        });

        document.querySelectorAll('section[id]').forEach(section => {
            observer.observe(section);
        });


        function updateProgressBar(currentSectionId) {
            const sections = ['objectives', 'concepts', 'applied', 'activities', 'practice', 'synthesis'];
            const totalSections = sections.length;
            let sectionIndex = sections.findIndex(id => id === currentSectionId);
            
            // If the section is found, update progress. Use a default if not found (e.g., 0%)
            if (sectionIndex !== -1) {
                // Base progress on the index (0-indexed)
                progress = ((sectionIndex + 1) / totalSections) * 100;
            } else if (window.scrollY === 0) {
                 progress = 0; // Reset to 0 at the very top
            }

            // Ensure progress is not calculated multiple times for the same scroll position
            if (progressBar.style.width !== `${progress}%`) {
                progressBar.style.width = `${progress}%`;
                localStorage.setItem('classProgress', progress);
            }
        }

        // Add scroll event listener as a fallback or for more immediate updates
        window.addEventListener('scroll', () => {
             // Find the section closest to the top of the viewport
            const sections = document.querySelectorAll('main > section');
            let topSection = sections[0];
            let minDistance = Infinity;

            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                const distance = Math.abs(rect.top);

                if (distance < minDistance) {
                    minDistance = distance;
                    topSection = section;
                }
            });

            if (topSection) {
                 updateProgressBar(topSection.id);
            }
        });


        function speakText(text) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                // Setting voice properties for better quality, if available
                utterance.lang = 'en-US'; 
                speechSynthesis.speak(utterance);
            } else {
                // Using a simple message box instead of alert()
                const container = document.body.querySelector('.container');
                const msgBox = document.createElement('div');
                msgBox.className = 'feedback incorrect';
                msgBox.style.position = 'fixed';
                msgBox.style.bottom = '20px';
                msgBox.style.right = '20px';
                msgBox.style.zIndex = '2000';
                msgBox.textContent = "Speech Synthesis not supported in this browser.";
                document.body.appendChild(msgBox);
                setTimeout(() => msgBox.remove(), 3000);
            }
        }

        function addScore(points) {
            score += points;
            localStorage.setItem('classScore', score);
            document.getElementById('score-display').textContent = `Score: ${score}`;
        }

        function checkDragAndDrop() {
            let correctCount = 0;
            const dropTargets = document.querySelectorAll('.drop-target');
            const feedback = document.getElementById('dd-feedback');
            
            dropTargets.forEach(target => {
                const draggedItem = target.querySelector('.drag-item');
                // Check if an item is dropped AND if its data-name matches the target's data-answer
                if (draggedItem && draggedItem.dataset.name === target.dataset.answer) {
                    target.classList.remove('incorrect');
                    target.classList.add('correct');
                    correctCount++;
                } else {
                    target.classList.remove('correct');
                    // Only mark as incorrect if a wrong item is dropped, or if empty and should not be.
                    if (draggedItem) { 
                       target.classList.add('incorrect');
                    }
                }
            });

            if (correctCount === dropTargets.length) {
                feedback.textContent = "Excellent! You have matched all the concepts correctly. You've earned 10 points!";
                feedback.className = 'feedback correct';
                addScore(10);
            } else {
                feedback.textContent = `Keep trying! You got ${correctCount} out of ${dropTargets.length} correct.`;
                feedback.className = 'feedback incorrect';
            }
        }

        function checkFillInTheBlank() {
            const answerInput = document.getElementById('blank1');
            const feedback = document.getElementById('fitb-feedback');
            const answer = answerInput.value.trim().toLowerCase();
            const correctAnswer = 'section';
            
            // Check if the input contains the word 'section'
            if (answer.includes(correctAnswer)) {
                feedback.textContent = "Correct! Section breaks are essential for changing page formatting within a single document. You've earned 5 points!";
                feedback.className = 'feedback correct';
                addScore(5);
            } else {
                feedback.textContent = `Incorrect. The correct answer is '${correctAnswer}'. A simple page break would not work for this task.`;
                feedback.className = 'feedback incorrect';
            }
        }

        function checkMultipleChoice(element, correctness) {
            // Prevent re-checking
            if (document.getElementById('mc-feedback').classList.contains('correct') || document.getElementById('mc-feedback').classList.contains('incorrect')) {
                return;
            }

            const feedback = document.getElementById('mc-feedback');

            // Visually highlight all options based on correctness
            document.querySelectorAll('.multiple-choice-option').forEach(option => {
                option.style.pointerEvents = 'none'; // Disable all options
                if (option.textContent.trim() === 'Match case') {
                    option.style.backgroundColor = 'var(--accent-color-light)';
                    option.style.color = 'white';
                }
            });

            if (correctness === 'correct') {
                feedback.textContent = "Precisely! 'Match case' is the key to differentiating between 'computer' (lower case) and 'Computer' (capitalized). You've earned 5 points!";
                feedback.className = 'feedback correct';
                addScore(5);
            } else {
                element.style.backgroundColor = '#fecaca'; // Highlight incorrect choice
                feedback.textContent = "Not quite. 'Match case' is the correct choice to differentiate capitalization.";
                feedback.className = 'feedback incorrect';
            }
        }

        // Initialize progress bar width on load
        if (progress > 0) {
            progressBar.style.width = `${progress}%`;
        }
    </script>
</body>
</html>
